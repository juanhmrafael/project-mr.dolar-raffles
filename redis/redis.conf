# ================================================================================================
# DockerGuard v4.1 - Configuración de Redis de Producción (Optimizada y Endurecida)
# Fuente Canónica de Conceptos: Documentación oficial de Redis (redis.io/docs)
# Propósito: Única fuente de verdad para la configuración de Redis, optimizada para rendimiento y resiliencia.
# ================================================================================================

# --- CONFIGURACIÓN DE RED Y CONEXIONES ---
bind 0.0.0.0
port 6379
protected-mode yes
tcp-keepalive 300

# --- GESTIÓN DE MEMORIA (CRÍTICO PARA PRODUCCIÓN) ---
maxmemory 400mb
maxmemory-policy allkeys-lru

# --- PERSISTENCIA DE DATOS (ESTRATEGIA AOF-ONLY) ---
dir /data
appendonly yes
appendfsync everysec
save ""

# --- LOGGING Y OBSERVABILIDAD ---
loglevel notice
logfile ""

# --- NOTIFICACIONES DEL KEYSPACE ---
notify-keyspace-events "Ex"

# --- LISTADO DE CONTROL DE ACCESO (ACL) ---
# Directiva de Seguridad: Deshabilita el usuario 'default'. Principio de privilegios mínimos.
user default off

# Define nuestro usuario de aplicación 'appuser'.
user appuser on >PASSWORD_PLACEHOLDER ~* +@all